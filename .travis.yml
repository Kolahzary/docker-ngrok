sudo: required
language: ruby
services:
- docker
before_install:
- sed -i "s/_MTPROXY_SECRET_/$MTPROXY_SECRET/g" docker-compose.yml
- sed -i "s/_MTPROXY_TAG_/$MTPROXY_TAG/g" docker-compose.yml
- sed -i "s/_NGROK_AUTH_/$NGROK_AUTH/g" docker-compose.yml
- docker-compose build
- docker-compose up -d
- docker-compose ps
- docker-compose logs mtproxy
- docker-compose logs ngrok
script:
- "./test.sh"
after_success:
- "./deploy.sh"
env:
  global:
  - secure: D3ddKl3sJi5JGpLMqL6CFK+YeSyblewTAy+DdLCCRNemQbSViO4SuUpiFEfV/1PRdK3L8a67+JrTZ6939fPrTfUzdfGZ8y5DkxRk/K6Pj5wexfYdiifQqBXe34QJddl/Ns0GO6svT2bWdLfxjf6Oh1dKBGbPxyWnwv1DRhrsyt9Q9yhwzS0XV+Wy+V564da6ham26aBISrTUIci4B0bb/9LuJp1DWKQoKZfAUNRVtVT5/PgapwjHK/bPuIbc+BG5FsG12xHV1N1jaeFz8xYDQwAVxFCzbTpjfn+ja848XxLMzgFf2SNIxM9yxgVYjI0iYAlxEP7R94FcUWikSsjx09kEUumkxFkeEj5vdwhp7PiWYtB8cJWnf8MNgTWWkuS1hqm+c+j2l1yIH+eGIxlFp0zmFxrksvEBb6PkWQ3kOA/eVOwMwsNY76LdJYe5kTtGaZNJVHCRmVXw6AhPf13HY8fzmM5Ua1DsF8gK788HG9xSPhIo1+87J/lWEis8paGJTccH9boqa8eY+4ytNadqC+tQ1daMyDjaIEvYRf0fuypMyyqTznsfuCO0b8oKCCnD8Ocra+Heed+pzsG8onY5j/F+PjVdumJuBjUdXtxka6kGJdwEL6WoxCy/UlcvjcMIZmSI5N7DgkAPdSpE9HpRoZYShQtbDRGy473GTvKZVX4=
  - secure: WBeibiXt8hzaHBKMJyyFUu5LkBnHjMudti4HHGSyVWUNMCiC8biTvqLF7o6TRhZvts40JDIW1stX+BAMtePm76XBEBYvE2e0IJ7bJkpE2dOn6wFyPZgYNVkx4V6jRkhlrRr9vAC+kCN3eZKrTiM2PLx/DGK2kFH4SJb7FRc6tDJexVnuug0yo7KmzOuBnWhljJ/SEKutLDV2bSTtTwotT2opt6GHei8lB3uwGPRJTKZ+InM7W+dFusRfu2V/T3buY5cw+6ra3sG6bjy1sKz3as8o4SOgdPyngYr7uT6HjQDXStmcL3Lok65Wz4xzi52/mWtfG4QNLNqH7tWilnc9yRIlDThRFPspmwFciG+EtCGLIPw8V90UIwvaNx1h/+R3a6nhqn0vBX47xKPYrc06GpuIG6MSsX4cDTkswcwMqD16V4+64JV1IldGGP0G10TOfH7b6jnIh5H1jUbDUq6WPkIbwM5zXRL/gENQB8Q0x3GVwkE8tC0rfVf9d4nooR16dx63hP7jGdBEA+Mw1/b3JhT+elPAEo6E6KfWY0EJsj0xIVcELoSAyOlyDUFTsiwarKPAF0zE0c+Vzy5zbVIh80tmt1PUp/ZP1vkc6+cSchHFYdaz7fD3DJGEqXGG2A6AXQ2AIVFmHEXJAn0YdcI9pmc81tDH0snq183ylo4ySK4=
  - secure: KdLl+0S+t0JieWePZ+iFm0SxiwUKZdIng5yra+PStTxz/OmEPl6nBMJngyoMbjXSNRL4bVf68lYOKOVqYw2aoY7U7Sbp+G6Lxh9jLNViGgeepGDMW7OI+OGTpBjGjh87jaHc3ReEozJ+r3D/ijzZYlHiiEQAUgOs56aLQECxfNcZvl08xdJHg/MfngMro7IZL1i59FFKrFwqp5KM0rO3vA8m24DSzJTYUSnLNy0HIJ4C5SAvgD3zMTC460hxZUT/3briCAvhRFuOyF7PIXUVcAKvzjswTYe6Gi0rnkI1R78pcrEV4z/Qq1DP2ECRDIWv0pYwh1CXgAzzFmYABE0N8mkc/znC8XcNbz+VXsaN8CtKeGC5XCIWgoTv/pdI7IdMF4jQObFFB8fCVxSsv1PtZLC0qSAEzva7sfI5Avi7zKvWRgLmqStfnXf6tn0pHc0A2HZnX58OqRgzvJ872fxExLBjNUERcrIuPa+4/imLKqTOOsFTAsXLr5L9LbRSEQ4KJWUeCen5xc8iDjAcTkfD7mmxeR++KMVSUAQF13L7mUEMiSFsJnpNvYmfsMhaTpB77x8Im9kRpnMjMltTKw1wV0kwMrrYh/fFcr9WR+obfnQ9O9dfMbnCnJGp8UbBEZQm3a/6uN+wo10GI+sYBonuYj9726WqV++eiTT5XVL96fU=
  - secure: DAdUv/1eCifnoA0H19ApGuCaE0J1pt9qfdlQ1lRHJymUeOlW8W/Hbu4LQMszh7pYo4HoE4ANJ3f64OqsnRqcolm1RCteGhZGF+N0FESubmSwtcGhGJ/m74cBasYvvtwxm5NcMtwz4qdOr93zH14rNMwGMnA2/BYVdKi7j1b/i0GMTYMWtHGIQ8adBIB3zOy7k384NbIQFRgUBCtURvkm7EfLuRAy7b3N00RvOPkGS1Sphtc9GlTW0AAEUMKcEKDDeunRvgesuZuzQ4FpMkCXO3ohM9BiHNlSccC6S9ulZdwqBNRG0efreKKz52OJ8/5IjT9kexkyfwGPK/absYitL4HHJ855PTaSk19DsOGpzTJGDL/4SDVn+YUkZ9/ACFWi11yV7QOk4S7px7Gj1Jvbpo3FWyIStvkgXfVO/MN1bpS0hyBpLPpqqtEV0URXXgigH/vRPmPVxBEENgCdoY6X2kcTZdAfKutkOrYLvB2AXtrr+3q97m9CH5/uqvNAFCp/Q+9SS3qIadFmAPzD0YUI4cyY8hE0UTHKfsOq6CRM5QlRgkGoQjYyQ7WZ6AcvfpTsjQ+3bS95wEn1ZiIFStcFyyVIVSC6w25BFUA9S+Tl+OWiONi8uBpy4y2Na6qLa3za+PJnuuqSt9seIQpMvm6VnD6raAhasNRYNh3xsRWtr6s=
  - secure: LKx90ZFGhfeaDmGh+Kh2tj/GQy3NJiuFTSHq94FK9Op7A39mt6vWLc2udLz84zrPeEwPYAhFLFrk1rbjTA4xv/NJiD5uKckxhfbtRm4wbBFaxWIJ3uRi72MdR6ppa53In2g5CuTuYua0NTB7mioXwOnFzdIppmIrtAr+ufu/LWA6CYuWXHUjFVW1QOzkW7P37NucY6cqi4t18SYAntNNBHPEaLBrndMm45H1ylOYKebEIMHfPvuv0iKyNwWMEIap5a1NZ2cBVIxQ809AfpC+86+IuXog/by/DFG8Tp0F2gpQIaKaBOdidu/h6Gsu2ibcq+rrBhNHkpxhf/ViJztKOi5xBQBUZ4wGSBG9dRUnoK5MmKF5mlmgRA7tau+hBhaQ6TiKlDHRipoCcfoiRkY85WBFnyz6FMovYFYgb92fGVT8IUwJp7Iwr5TlUQsZmoLWCg1f8szpzo9rHBiMaJ6YwxC8NQqq2X2wodqihxfJdk0INGcgQur0Y3wewH5RjViHDsAFosqvTThWyfln0AmrVl4aP/IJiWP0cggc10nb1i+y5cAeDYiekibLNwOya9raRPwHwbLBFzYDGkI9XArndFLMolozmuq6KEah4i3obOGNLhOUGJGul7JVdPvy21anURclwJUCafUZhLsX5+CHi5NmUf/JLrCw+JeaF7aFQGE=
